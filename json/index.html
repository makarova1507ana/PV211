<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
<button >button</button>
    <script>
       //promise
        const requestUrl ='https://jsonplaceholder.typicode.com/users';
       

        function sendRequest(method, url){        
            new Promise((resolve,reject)=>{//resolve  успешная обработка, reject вызываем если просохоидт какая-то ошибка
                let xhr = new XMLHttpRequest();
                xhr.open(method, url);//Метод и ссылку
                xhr.responseType = 'json';
                xhr.onload=()=>{//при загрузке данных

                    if (xhr.status >= 400){
                        reject( xhr.response); //xhr.response[0]['name']);
                    }else{
                        resolve( xhr.response); 
                    }
                }
                xhr.onerror = () =>{// после загрузки какая-то другая ошибка
                    reject( xhr.response);
                }
                xhr.send();
            })
            .then(data => (
                console.log('good data',data))//return !!!
            )//в случае успешного выполнения кода

            .catch(err => (
                console.log('error data',err))
            )//в случае неуспешного выполнения кода
           
     }
document.querySelector('button').addEventListener('click',function(){sendRequest('GET',requestUrl)});


//function array_name_users()        

// эмуляция синхронной работы сервера
       /* console.log('Request data');
        setTimeout(()=>{
            console.log('Preparing data');
            console.log('response data');

        },2000)*/
        

      // эмуляция асинхронной работы сервера
       /* console.log('Request data');
        setTimeout(()=>{
            console.log('Preparing data');
            
            setTimeout(()=>{// вложенная конструкция
                console.log('Preparing data');

                setTimeout(()=>{// вложенная конструкция
                console.log('response data');

                
                     setTimeout(()=>{// вложенная конструкция
                        console.log('response data');
                
                    },2000)
                },2000)

            },2000)

        },2000)*/
       


        // this is better
       /* function f(){
        console.log('Request data');
        let process = new Promise(function(resolve, reject){
            setTimeout(()=>{
                console.log('Preparing data');
                preparing_data = 'my_data';
                resolve(preparing_data);// когда выполнится выполняем, какое-то другое действие
            },2000) // в ожидании когда процесс выполнится
        }).then(preparing_data  => {// когда процесс process выполнится
            console.log(preparing_data);       //то выполним действие

           
            console.log('modified data');
            modified_data = 'return modified my_data';
            return modified_data
        }).then(modified_data=>{
            
                console.log(modified_data);       //то выполним действие
            
        })
    }*/
    </script>
</body>
</html>